# Dommel-Access
Extend Dommel to provide CRUD operations for Dapper into Access.

## Dommel

[Dommel](https://github.com/henkmollema/Dommel) provides a convenient API for CRUD operations using extension methods on the `IDbConnection` interface. 
The SQL queries are generated based on your POCO entities. 
Dommel also supports LINQ expressions which are being translated to SQL expressions. 
[Dapper](https://github.com/StackExchange/dapper-dot-net) is used for query execution and object mapping.

Dommel also provides extensibility points to change the bevahior of resolving table names, column names, 
the key property and POCO properties. See [Extensibility](https://github.com/henkmollema/Dommel#extensibility) 
for more details.

## Dommel Access Provider

This provider depends on a slight modification of Dommel, currently pending a pull request, 
and available [here](https://github.com/jmreynolds/Dommel).

It provides an implementation of `DommelMapper.ISqlBuilder`, 
as well as an implementation of a new interface, `DommelMapper.IUpdateBuilder`.

Using these two implementations, it is possible to continue using the Dommel API, complete with 
generic POCO entities and mapping resolution, while using the Access-compliant syntax for SQL Parameters.

### The API

The API follows the [same API as Dommel](https://github.com/henkmollema/Dommel#the-api).
The only changes are to the SQL generated by Insert and Update queries.

#### Inserting entities

The following CSharp snippet:

```csharp
using (var con = new SqlConnection())
{
   var product = new Product { Name = "Awesome bike", InStock = 4 };
   int id = con.Insert(product);
}
```

Will generate the following SQL Query:

```sql
INSERT INTO Products 
    (Name, InStock)
VALUES
    (?Name?, ?InStock?)
```

#### Updating entities

Similarly, the following CSharp Update Snippet:

```csharp
using (var con = new SqlConnection())
{
   var product = con.Get<Product>(1);
   product.LastUpdate = DateTime.Now;
   con.Update(product);
}
```

Generates this SQL query:

```sql
UPDATE Products
Set
    Name = ?Name?, 
    InStock = ?InStock?,
    LastUpdate = ?LastUpdate?
WHERE
    Id = ?Id?
```

